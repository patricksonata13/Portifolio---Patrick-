<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Visualizar Roteiro | Patika</title>
    <link rel="stylesheet" href="css/patika-app.css">
    <style>
        body { background: #222; padding: 50px; display: flex; justify-content: center; }
        .paper { 
            background: white; 
            color: black; 
            width: 210mm; /* Tamanho A4 */
            min-height: 297mm;
            padding: 25mm;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            font-family: 'Courier Prime', 'Courier', monospace;
            font-size: 12pt;
            line-height: 1.2;
        }
        @media print {
            body { background: none; padding: 0; }
            .paper { box-shadow: none; width: 100%; }
            .no-print { display: none; }
        }
        .no-print { position: fixed; top: 20px; left: 20px; }
        button { padding: 10px 20px; cursor: pointer; background: #007aff; color: #fff; border: none; border-radius: 5px; }
    </style>
</head>
<body>
    <div class="no-print">
        <button onclick="window.print()">Imprimir / PDF</button>
        <button onclick="location.href='index.html'" style="background:#444">Voltar</button>
    </div>

    <div id="render-area" class="paper">
        Carregando roteiro para visualização...
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="../../assets/js/supabase-client.js"></script>
    <script>
        async function loadForView() {
            const { data: { user } } = await window.supabaseClient.auth.getUser();
            if (!user) { alert("Faça login primeiro!"); return; }

            const { data, error } = await window.supabaseClient
                .from('roteiros')
                .select('corpo')
                .eq('user_id', user.id)
                .single();

            if (data) {
                document.getElementById('render-area').innerHTML = data.corpo;
            }
        }
        loadForView();
    </script>
</body>
</html>
