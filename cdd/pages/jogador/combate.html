<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CDD 3001 ‚Ä¢ COMBATE</title>
    <link rel="stylesheet" href="/assets/css/global.css">
    <style>
        body { padding: 20px; }
        .combate-grid {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 20px;
            margin: 20px 0;
        }
        .inimigos-lista {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        .inimigo-card {
            background: #14181c;
            border: 1px solid #ff4444;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .inimigo-card:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(255, 68, 68, 0.3);
        }
        .inimigo-card.seguro {
            border-color: #4ade80;
        }
        .inimigo-card.seguro:hover {
            box-shadow: 0 0 30px rgba(74, 222, 128, 0.3);
        }
        .status-jogador {
            background: #0f1215;
            border: 1px solid #1e293b;
            padding: 20px;
            position: sticky;
            top: 20px;
        }
        .barra-status {
            height: 8px;
            background: #1e293b;
            margin: 10px 0;
            border-radius: 4px;
        }
        .preenchimento {
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s;
        }
        .hp { background: #4ade80; }
        .mana { background: #b3a0ff; }
        .xp { background: #ffd966; }
    </style>
</head>
<body>
    <div class="terminal">
        <div class="terminal-header">
            <span class="terminal-path">CDD-3001/COMBATE</span>
            <span class="terminal-status">‚öîÔ∏è ZONA DE RISCO</span>
        </div>

        <div style="display: flex; justify-content: space-between; align-items: center; margin: 20px;">
            <h1>‚öîÔ∏è √ÅREA DE COMBATE</h1>
            <a href="/cdd/" class="btn">‚Üê VOLTAR</a>
        </div>

        <div class="combate-grid">
            <!-- Lista de Inimigos -->
            <div>
                <h3 style="color: #ffd966; margin-bottom: 15px;">üëæ INIMIGOS NA √ÅREA</h3>
                <div class="inimigos-lista">
                    <div class="inimigo-card" onclick="iniciarCombate('branquelo')">
                        <div style="font-size: 40px; text-align: center;">üëª</div>
                        <div style="font-weight: bold; color: #a0a0a0;">BRANQUELO</div>
                        <div style="color: #64748b;">N√≠vel 1 ‚Ä¢ +15 XP</div>
                        <div style="font-size: 12px; color: #ff4444;">HP: 30</div>
                    </div>

                    <div class="inimigo-card" onclick="iniciarCombate('sentinela')">
                        <div style="font-size: 40px; text-align: center;">üë§</div>
                        <div style="font-weight: bold; color: #ffd966;">SENTINELA</div>
                        <div style="color: #64748b;">N√≠vel 3 ‚Ä¢ +50 XP</div>
                        <div style="font-size: 12px; color: #ff4444;">HP: 60</div>
                    </div>

                    <div class="inimigo-card" onclick="iniciarCombate('eco')">
                        <div style="font-size: 40px; text-align: center;">üë•</div>
                        <div style="font-weight: bold; color: #b3a0ff;">ECO</div>
                        <div style="color: #64748b;">N√≠vel 5 ‚Ä¢ +100 XP</div>
                        <div style="font-size: 12px; color: #ff4444;">HP: 100</div>
                    </div>

                    <div class="inimigo-card" onclick="iniciarCombate('alfa')">
                        <div style="font-size: 40px; text-align: center;">üíÄ</div>
                        <div style="font-weight: bold; color: #ff4444;">ALFA</div>
                        <div style="color: #64748b;">N√≠vel 8 ‚Ä¢ +300 XP</div>
                        <div style="font-size: 12px; color: #ff4444;">HP: 200</div>
                    </div>

                    <div class="inimigo-card seguro" onclick="window.location.href='/cdd/'">
                        <div style="font-size: 40px; text-align: center;">üè†</div>
                        <div style="font-weight: bold; color: #4ade80;">√ÅREA SEGURA</div>
                        <div style="color: #64748b;">Voltar ao terminal</div>
                    </div>
                </div>
            </div>

            <!-- Status do Jogador -->
            <div>
                <div class="status-jogador">
                    <h3 style="color: #ffd966; margin-bottom: 15px;">üìä STATUS</h3>
                    
                    <div style="margin-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between;">
                            <span>HP</span>
                            <span id="hp-atual">50/50</span>
                        </div>
                        <div class="barra-status">
                            <div id="barra-hp" class="preenchimento hp" style="width: 100%;"></div>
                        </div>
                    </div>

                    <div style="margin-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between;">
                            <span>MANA</span>
                            <span id="mana-atual">30/30</span>
                        </div>
                        <div class="barra-status">
                            <div id="barra-mana" class="preenchimento mana" style="width: 100%;"></div>
                        </div>
                    </div>

                    <div style="margin-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between;">
                            <span>XP</span>
                            <span id="xp-atual">0/100</span>
                        </div>
                        <div class="barra-status">
                            <div id="barra-xp" class="preenchimento xp" style="width: 0%;"></div>
                        </div>
                    </div>

                    <div style="color: #64748b; font-size: 12px; margin-top: 15px;">
                        <div>‚öîÔ∏è For√ßa: <span id="forca">10</span></div>
                        <div>üõ°Ô∏è Defesa: <span id="defesa">5</span></div>
                        <div>üéØ Precis√£o: <span id="precisao">8</span></div>
                    </div>

                    <div style="margin-top: 20px;">
                        <button class="btn" style="width: 100%;" onclick="window.location.href='/cdd/inventario/'">
                            üéí INVENT√ÅRIO
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/cdd/assets/js/rpg-system.js"></script>
    <script src="/cdd/assets/js/combate.js"></script>
    <script>
        function iniciarCombate(tipo) {
            if (sistemaCombate.iniciarCombate(tipo)) {
                mostrarTelaCombate();
            }
        }

        function mostrarTelaCombate() {
            const inimigo = sistemaCombate.inimigoAtual;
            
            const container = document.createElement('div');
            container.className = 'combate-container';
            container.id = 'tela-combate';
            
            const hpPercent = (inimigo.hpAtual / inimigo.hp) * 100;
            
            container.innerHTML = `
                <div class="inimigo-info">
                    <div class="inimigo-icon">${inimigo.icon}</div>
                    <div>
                        <div class="inimigo-nome">${inimigo.nome}</div>
                        <div style="color: #64748b;">N√≠vel ${inimigo.nivel}</div>
                    </div>
                </div>
                
                <div>
                    <div style="display: flex; justify-content: space-between;">
                        <span>HP: ${inimigo.hpAtual}/${inimigo.hp}</span>
                        <span>${Math.round(hpPercent)}%</span>
                    </div>
                    <div class="barra-hp">
                        <div class="hp-atual" style="width: ${hpPercent}%;"></div>
                    </div>
                </div>

                <div class="combate-acoes">
                    <button class="btn-combate" onclick="sistemaCombate.atacar()">‚öîÔ∏è ATACAR</button>
                    <button class="btn-combate" onclick="usarHabilidade('cura')">üíö CURAR</button>
                    <button class="btn-combate" onclick="usarHabilidade('furia')">üí¢ F√öRIA</button>
                    <button class="btn-combate" onclick="sistemaCombate.fugir()">üèÉ FUGIR</button>
                </div>

                <div style="margin-top: 15px; font-size: 12px; color: #64748b; text-align: center;">
                    Dano base: ${rpg.jogador.atributos.forca} + 1-8
                </div>
            `;
            
            // Remover tela anterior se existir
            const anterior = document.getElementById('tela-combate');
            if (anterior) anterior.remove();
            
            document.body.appendChild(container);
        }

        function usarHabilidade(habilidade) {
            sistemaCombate.usarHabilidade(habilidade);
            if (sistemaCombate.emCombate) {
                mostrarTelaCombate();
            } else {
                document.getElementById('tela-combate')?.remove();
            }
        }

        // Atualizar status do jogador
        function atualizarStatus() {
            if (rpg) {
                document.getElementById('hp-atual').textContent = `${rpg.jogador.atributos.hp || 50}/50`;
                document.getElementById('mana-atual').textContent = `${rpg.jogador.recursos.mana || 30}/30`;
                document.getElementById('xp-atual').textContent = `${rpg.jogador.xp || 0}/${rpg.jogador.xpProximoNivel || 100}`;
                
                const xpPercent = (rpg.jogador.xp / rpg.jogador.xpProximoNivel) * 100 || 0;
                document.getElementById('barra-xp').style.width = xpPercent + '%';
                
                document.getElementById('forca').textContent = rpg.jogador.atributos.forca || 10;
                document.getElementById('defesa').textContent = rpg.jogador.atributos.defesa || 5;
                document.getElementById('precisao').textContent = rpg.jogador.atributos.precisao || 8;
            }
        }

        setInterval(atualizarStatus, 1000);
        atualizarStatus();

        // Verificar combate a cada segundo
        setInterval(() => {
            if (sistemaCombate.emCombate) {
                mostrarTelaCombate();
            }
        }, 1000);
    </script>
</body>
</html>
